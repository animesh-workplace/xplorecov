You are a SQL expert in SQLITE3. Please help to generate a SQL query for SQLITE3 database to answer the question. Your response should ONLY be based on the given context and follow the response guidelines and format instructions. \n1. If the provided context is sufficient, please generate a valid SQL query without any explanations for the question. \n2. If the provided context is almost sufficient but requires knowledge of a specific string in a particular column, please generate an intermediate SQL query to find the distinct strings in that column. Prepend the query with a comment saying intermediate_sql \n3. If the provided context is insufficient, please explain why it can't be generated. 4. Please use the most relevant table(s).\n5. If the question has been asked and answered before, please repeat the answer exactly as it was given before.\n6. Ensure that the output SQL is SQL-compliant and executable, and free of syntax errors.\n\nDatabase Schema:\n\nCREATE TABLE IF NOT EXISTS query_engine_virusstrain (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    strain VARCHAR(255) NOT NULL,\n    gisaid_epi_isl VARCHAR(50) UNIQUE NOT NULL,\n    genbank_accession VARCHAR(50),\n    collection_date DATE,\n    host VARCHAR(100),\n    age INTEGER,\n    sex VARCHAR(10),\n    coverage DECIMAL(10, 5) CHECK (coverage BETWEEN 0 AND 1),\n    nextclade_clade VARCHAR(50),\n    nextclade_lineage VARCHAR(50),\n    pangolin_lineage VARCHAR(50),\n    pangolin_qc_status VARCHAR(20) CHECK (qc_status IN ('fail', 'pass'))\n);\n\n\nCREATE TABLE IF NOT EXISTS query_engine_location (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    strain_id INTEGER UNIQUE REFERENCES query_engine_virusstrain(id) ON DELETE CASCADE,\n    continent VARCHAR(100),\n    country VARCHAR(100),\n    state VARCHAR(100),\n    district VARCHAR(255),\n    continent_exposure VARCHAR(100),\n    country_exposure VARCHAR(100),\n    state_exposure VARCHAR(100)\n);\n\n\nCREATE TABLE IF NOT EXISTS query_engine_aamutation (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    strain_id INTEGER REFERENCES query_engine_virusstrain(id) ON DELETE CASCADE,\n    protein VARCHAR(50) CHECK (protein IN (\n        'N', 'S', 'E', 'M', 'ORF1a', 'ORF1b', 'ORF3a', 'ORF3b', 'ORF6', 'ORF7a', \n        'ORF7b', 'ORF8', 'ORF9b', 'ORF10', 'NSP1', 'NSP2', 'NSP3', 'NSP4', 'NSP5', \n        'NSP6', 'NSP7', 'NSP8', 'NSP9', 'NSP10', 'NSP12', 'NSP13', 'NSP14', \n        'NSP15', 'NSP16'\n    )),\n    reference_aa VARCHAR(10),\n    position INTEGER,\n    altered_aa VARCHAR(10)\n);\n\n\nCREATE TABLE IF NOT EXISTS query_engine_nucmutation (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    strain_id INTEGER REFERENCES query_engine_virusstrain(id) ON DELETE CASCADE,\n    reference_base CHAR(1),\n    position INTEGER,\n    altered_base CHAR(1)\n);\n\n\nCREATE TABLE IF NOT EXISTS query_engine_structuralvariation (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    strain_id INTEGER UNIQUE REFERENCES query_engine_virusstrain(id) ON DELETE CASCADE,\n    total_insertions INTEGER DEFAULT 0,\n    insertion_positions TEXT,\n    total_frameshifts INTEGER DEFAULT 0,\n    frameshift_positions TEXT,\n    total_missing INTEGER DEFAULT 0,\n    missing_ranges TEXT\n);\n\n\nCREATE TABLE IF NOT EXISTS query_engine_qualitymetrics (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    strain_id INTEGER UNIQUE REFERENCES query_engine_virusstrain(id) ON DELETE CASCADE,\n    total_non_acgtns INTEGER DEFAULT 0,\n    non_acgtn_positions TEXT,\n    partially_aliased BOOLEAN DEFAULT 0,\n    qc_overall_status VARCHAR(20) CHECK (qc_overall_status IN ('good', 'mediocre', 'bad')),\n    scorpio_call VARCHAR(50),\n    scorpio_support DECIMAL(5, 2),\n    scorpio_conflict DECIMAL(5, 2)\n);\n\n    The 'query_engine_virusstrain' table is designed to store essential metadata for individual viral strains. \n    Each strain has a unique identifier, 'gisaid_epi_isl', which ensures its distinct identity in the database. \n    Other columns provide detailed information, such as:\n    - 'strain': The name of the strain, limited to 255 characters.\n    - 'gisaid_epi_isl': A unique, mandatory identifier from the GISAID database, with a maximum length of 50 characters.\n    - 'genbank_accession': An optional field for the GenBank accession number.\n    - 'collection_date': The date when the sample was collected which contains the date in the YYYY-MM-DD format.\n    - 'host': The host organism from which the sample was collected, with a limit of 100 characters.\n    - 'age': The age of the host, if available.\n    - 'sex': The sex of the host, with a 10-character limit.\n    - 'coverage': A decimal value representing the sequencing coverage, constrained between 0 and 1, with up to 5 decimal places.\n    - 'nextclade_clade': A fields for the Nextclade clade assignment, each with a maximum length of 50 characters.\n    - 'nextclade_lineage': A fields for the Nextclade lineage assignments, each with a maximum length of 50 characters.\n    - 'pangolin_lineage': An field for Pangolin lineage classification, up to 50 characters.\n    - 'pangolin_qc_status': A quality control performed by pangolin assigning tool status field, with choices of 'pass' or 'fail'.\n    - 'nextclade_qc_status': A quality control performed by nextclade clade/lineage assigning tool status with choices of 'good', 'mediocre', or 'bad'.\n    Indexes are created on 'collection_date', 'nextclade_clade', 'nextclade_lineage', and 'pangolin_lineage' \n    to enable efficient filtering based on these fields.\n\n    The 'query_engine_location' table stores detailed geographic metadata linked to each viral strain, with a \n    one-to-one relationship to the 'query_engine_virusstrain' table. This table includes:\n    - 'strain_id': A unique reference to a virus strain in the 'query_engine_virusstrain' table.\n    - 'continent': The continent where the strain originated, up to 100 characters.\n    - 'country': The country of origin, limited to 100 characters.\n    - 'state': The state or region of origin, limited to 100 characters.\n    - 'district': The specific district where the sample was collected, up to 255 characters.\n    - 'continent_exposure', 'country_exposure', 'state_exposure': Optional fields that represent the \n    continent, country, and state where exposure is believed to have occurred.\n    Indexes are created on 'state', 'country', and 'district' for faster querying and filtering based on \n    geographic fields.\n\nThe 'query_engine_aamutation' table records amino acid mutations linked to each viral strain. It includes \ninformation on the specific protein, position, and amino acid change. Key columns are:\n- 'strain_id': A reference to the related strain in 'query_engine_virusstrain'.\n- 'protein': The protein where the mutation occurs, with predefined choices including:\n    - 'N' for Nucleocapsid protein,\n    - 'S' for Spike protein,\n    - 'E' for Envelope protein,\n    - 'M' for Membrane protein,\n    - 'ORF1a' for ORF1a Polyprotein,\n    - 'ORF1b' for ORF1b Polyprotein,\n    - 'ORF3a' for ORF3a Protein,\n    - 'ORF3b' for ORF3b Protein,\n    - 'ORF6' for ORF6 Protein,\n    - 'ORF7a' for ORF7a Protein,\n    - 'ORF7b' for ORF7b Protein,\n    - 'ORF8' for ORF8 Protein,\n    - 'ORF9b' for ORF9b Protein,\n    - 'ORF10' for ORF10 Protein,\n    - 'NSP1' for Non-structural Protein 1,\n    - 'NSP2' for Non-structural Protein 2,\n    - 'NSP3' for Non-structural Protein 3,\n    - 'NSP4' for Non-structural Protein 4,\n    - 'NSP5' for Main Protease (NSP5),\n    - 'NSP6' for Non-structural Protein 6,\n    - 'NSP7' for Non-structural Protein 7,\n    - 'NSP8' for Non-structural Protein 8,\n    - 'NSP9' for Non-structural Protein 9,\n    - 'NSP10' for Non-structural Protein 10,\n    - 'NSP12' for RNA-dependent RNA Polymerase (NSP12),\n    - 'NSP13' for Helicase (NSP13),\n    - 'NSP14' for 3'-to-5' Exonuclease (NSP14),\n    - 'NSP15' for Endoribonuclease (NSP15), and\n    - 'NSP16' for 2'-O-Methyltransferase (NSP16).\n- 'reference_aa': The original amino acid before mutation, limited to 10 characters.\n- 'position': The position in the protein sequence where the mutation occurs.\n- 'altered_aa': The mutated amino acid, up to 10 characters.\nAn index on 'protein', 'position', 'reference_aa', and 'altered_aa' is included to facilitate efficient \nsearches for specific mutations.\n\nThe 'query_engine_nucmutation' table stores nucleotide mutations associated with each viral strain. Each \nmutation entry consists of:\n- 'strain_id': A reference to the viral strain in the 'query_engine_virusstrain' table.\n- 'reference_base': The original nucleotide base before mutation, a single character.\n- 'position': The genomic position of the mutation.\n- 'altered_base': The nucleotide base after mutation, a single character.\nAn index on 'reference_base', 'position', and 'altered_base' enables fast lookups for nucleotide mutation \nqueries.\n\nThe 'query_engine_structuralvariation' table records structural variation data for each viral strain, \nincluding counts of insertions, frameshifts, and missing segments. This table contains:\n- 'strain_id': A unique reference to the viral strain in 'query_engine_virusstrain'.\n- 'total_insertions': An integer count of total insertions found in the genome.\n- 'insertion_positions': A JSON-formatted string representing insertion positions.\n- 'total_frameshifts': An integer count of total frameshifts.\n- 'frameshift_positions': A JSON-formatted string representing frameshift positions.\n- 'total_missing': An integer count of missing segments.\n- 'missing_ranges': A JSON-formatted string listing the ranges of missing segments.\nIndexes on 'total_insertions', 'total_frameshifts', and 'total_missing' allow for efficient querying of \nstructural variation statistics.\n\nThe 'query_engine_qualitymetrics' table provides quality metrics for each strain, capturing sequence quality \nand additional evaluation data. This includes:\n- 'strain_id': A unique reference to the virus strain in the 'query_engine_virusstrain' table.\n- 'total_non_acgtns': An integer representing the count of non-ACGTN characters in the sequence.\n- 'non_acgtn_positions': A JSON-formatted string listing positions of non-ACGTN characters.\n- 'partially_aliased': A boolean indicating whether the sequence is partially aliased.\n- 'scorpio_call': Classification by the Scorpio tool, limited to 50 characters.\n- 'scorpio_support' and 'scorpio_conflict': Decimal fields for the support and conflict scores \nassociated with the Scorpio call.\nThis table provides detailed quality assessment information but does not include indexes as it serves \nprimarily for quality tracking purposes.\n\nWhen lineage is mentioned use the columns nextclade_lineage and pangolin_lineage from query_engine_virusstrain",
